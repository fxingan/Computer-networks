**第2次书面作业**

习题1（50分）

路由器R1的路由表如下表所示。主机A的IP地址为21.13.24.78，主机B的IP地址为176.11.64.129，主机C的IP地址为176.11.34.72；主机D的IP地址为176.11.31.168，主机E的IP地址为176.11.60.239，主机F的IP地址为192.36.8.73。路由器R1接收到分别发送到目的主机（主机A~主机F）的分组。请回答以下3个问题：

（1）根据R1的路由表信息推断并绘制出网络结构图。（22分）

（2）如果R3的E1与R2的E2的IP地址主机号均为5，那么这两个端口的IP地址是什么？（10分）

（3）对于目的地址为主机A~主机F的分组，它们的下一跳地址分别是什么？（18分）

| 网络地址    | 子网掩码      | 下一跳 | 转发端口 |
| ----------- | ------------- | ------ | -------- |
| 176.11.64.0 | 255.255.240.0 | R3的E1 | E2       |
| 176.11.16.0 | 255.255.240.0 | -      | E1       |
| 176.11.32.0 | 255.255.240.0 | -      | E2       |
| 176.11.48.0 | 255.255.240.0 | -      | E3       |
| 0.0.0.0     | 0.0.0.0       | R2的E2 | E1       |

（1）网络结构如下所示：

```javascript
            R2(E1)
              |
        +-----+-----+
        |           |
      R1(E1)     R1(E2)
        |           |
        +-----+-----+
              |
            R3(E1)
```

（2）如果R3的E1与R2的E2的IP地址主机号均为5，则R3的E1的IP地址应该与R2的E2的IP地址主机号相同。根据提供的子网掩码和网络地址，可以得出：R3的E1的IP地址：176.11.64.5 ，R2的E2的IP地址：176.11.64.5

（3）根据路由表信息和目的地址，下一跳地址如下：

- 目的地址为主机A（21.13.24.78）：下一跳地址为R3的E1（176.11.64.0/20）。
- 目的地址为主机B（176.11.64.129）：下一跳地址为R3的E1（176.11.64.0/20）。
- 目的地址为主机C（176.11.34.72）：下一跳地址为R2的E2（176.11.32.0/20）。
- 目的地址为主机D（176.11.31.168）：下一跳地址为R2的E2（176.11.32.0/20）。
- 目的地址为主机E（176.11.60.239）：下一跳地址为R3的E1（176.11.64.0/20）。
- 目的地址为主机F（192.36.8.73）：下一跳地址为默认路由R2的E2（0.0.0.0）。

 

习题2（50分）

网络结构如下图所示。主机A的MAC地址为00-15-C5-C1-5E-28，IP地址为10.2.128.100（私有地址），下方框中为该主机进行Web请求的1个以太网数据帧前80B的十六进制及ASCII码内容。请回答以下4个问题：

![](C:\Users\LEGION\AppData\Roaming\Typora\typora-user-images\image-20231216013556113.png)

（1）Web服务器的IP地址是什么？该主机的默认网关的MAC地址是什么？（10分）

（2）该主机在构造上图的数据帧时，使用什么协议确定目的MAC地址？封装该协议请求报文的以太网帧的目的MAC地址是什么？（10分）

（3）假设HTTP/1.1协议以持续的非流水线方式工作，一次请求/响应时间为RTT，rfc.html页面引用了5个JPG图像，则从发出上图中的Web请求开始到浏览器收到全部内容为止，需要经过多少个RTT？（15分）

（4）该帧所封装的IP分组经过路由器R转发时，需修改IP分组首部中的哪些字段？（15分）

（1）以太网帧首部有14字节，IP数据包首部目的IP地址前有16字节，所以目的IP地址在一台网帧中的位置应该是第31、32、33、34字节，即40.aa.62.20，转换成十进制为64.170.98.32。 目的MAC地址就是前6个字节，即00-21-27-21-51-ee所以该MAC地址就是默认网关10.2.128.1端口的物理地址。 

（2）使用了ARP协议，该协议主要用来解决IP地址到MAC地址的映射问题，当源主机知道目的主机的IP地址，而不知道目的主机的MAC地址时，主机的ARP进程就在本以太网上进行广播，此时以太网的目的MAC地址为全1，即ff-ff-ff-ff-ff-ff。 

（3）第一个 RTT用于请求 Web 页面，客户机收到第一个请求的响应后，每访问一次对象就用去一个 RTT，此时还有五个请求未发送，所以共需6个RTT后浏览器收到全部内容。

（4）题目中已经说明IP地址10.2.128.100是私有地址，所以经过路由器转发源IP地址是要发生改变的，即变成NAT路由器的一个全球IP地址，也就是将IP地址10.2.128.100改成101.12.123.15。计算得出，源IP地址字段0a  02 80 64需要改为65 0c 7b  0f。另外，IP分组每经过一个路由器，TTL字段都需要减1，初始生存时间字段为80，经过路由器R1之后变为7f，还需要重新计算头部校验和。